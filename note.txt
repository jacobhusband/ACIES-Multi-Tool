I have a project management application that has a "Clean DWGs" tool that is not working properly. It is intended to do the following:
1. user clicks on the tool and a user interface opens up asking for them to select a titleblock DWG, specify the size of the titleblock 22"x34", 24"x36", or "30"x42", and select the DWGs that are to be cleaned.
2. user clicks proceed button after filling out the user interface.
3. the selected files are then duplicated and moved to the users local documents in a directory named "AutoCAD Clean DWGs". The structure of the projects are in the format where there is the folder with the *project name* then inside that folder is the folders with the *discipline name* such as "Electrical" "Mechanical" "Plumbing" as well as the "Xref" folder where the Titleblock DWG is located. We want to copy the structure of the files locally so that the XREFs with saved relative paths are located. So for example the project might be named "Billy" so the user will select "Billy/Xref/TBLK.dwg" and "Billy/Electrical/1.DWG" as the title block DWG and CAD DWG. That structure needs to be replicated when the files are saved in the local documents. Also use a time stamp so we don't run into naming issues. For example, "AutoCAD Clean DWGs/Billy*timestamp*/Electrical/1.DWG" and "AutoCAD Clean DWGs/Billy*timestamp*/Xref/TBLK.dwg". All the manipulations should occur on the duplicated files and any reference to the DWGs are referencing these duplicated files.
3.5 when copying over the files make sure to copy over the entire contents of the discipline folder (aka "Electrical") and the Xref folder (where the titleblock is located). This ensures that any reference files used in the CAD DWGs or title block DWG are accessible from the duplicated file location.
4. the title block DWG should now open in AutoCAD and once it loads the command "CLEANTBLK" is automatically run from the AutoCAD command line and we wait for the process to finish. Provide the user the options to "undo the cleaning, I will handle it", "leave the cleaning, but let me fix it", "cleaning looks good, please continue". Then notify the user to close the Titleblock DWG to proceed if they selected an option to fix it themselves, otherwise save and close the DWG to continue.
5. the first CAD DWG should now open in AutoCAD and once it loads the command "CLEANCAD" is automatically run from the AutoCAD command line and we wait for the process to finish. Provide the user the options to "undo the cleaning, I will handle it", "leave the cleaning, but let me fix it", "cleaning looks good, please continue". Then notify the user to close the Titleblock DWG to proceed if they selected an option to fix it themselves, otherwise save the file in "current folder/AutoCAD Clean DWGs" and save as the layout names separated by spaces such as "E01.00 E01.01" if the CAD file had "E01.00" and "E01.01" as layout names. Exclude the model space layout. Then close the DWG to continue.
6. Repeat the cleaning process for all CAD DWGS.
7. Once the title block DWG and all CAD DWGs have been processed, open the resulting folder with the processed CAD DWGs for the user to see and do as they please.

Currently the "Clean DWGs" tool does not do the following:
- The tool does not bring the "User Action Required" window into focus. Please fix this by bringing this window into focus in the foreground when it is opened.
- The tool does not clean all the user selected CAD DWG files. It stops after the first one is complete. Please fix this by moving on to the subsequent CAD DWG files after saving and closing the first one.