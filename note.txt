I have a project management application that has a "Clean DWGs" tool that is not working properly. It is intended to do the following:
1. user clicks on the tool and a user interface opens up asking for them to select a titleblock DWG and check mark the directories to be cleaned.
2. user clicks proceed button after filling out the user interface.
3. the selected files are then duplicated and moved to the users local documents in a directory named "AutoCAD Clean DWGs". The structure of the projects are in the format where there is the folder with the *project name* then inside that folder is the folders with the *discipline name* such as "Electrical" "Mechanical" "Plumbing" as well as the "Xrefs" folder where the Titleblock DWG is located. We want to copy the structure of the files locally so that the XREFs with saved relative paths are located. So for example the project might be named "Billy" so the user will select "Billy/Xref/TBLK.dwg" and "Billy/Electrical/1.DWG" as the title block DWG and CAD DWG. That structure needs to be replicated when the files are saved in the local documents. Also use a time stamp so we don't run into naming issues. For example, "AutoCAD Clean DWGs/Billy*timestamp*/Electrical/1.DWG" and "AutoCAD Clean DWGs/Billy*timestamp*/Xref/TBLK.dwg". All the manipulations should occur on the duplicated files and any reference to the DWGs are referencing these duplicated files.
3.5 when copying over the files make sure to copy over the entire contents of the discipline folder (aka "Electrical") and the Xref folder (where the titleblock is located). This ensures that any reference files used in the CAD DWGs or title block DWG are accessible from the duplicated file location.
4. the title block DWG should now open in AutoCAD and once it loads the command "CLEANTBLK" is automatically run from the AutoCAD command line and we wait for the user to complete the command by selecting (2) corner points making up the boundary of the rectangular title block. Provide the user the options to "undo the cleaning, I will handle it", "leave the cleaning, but let me fix it", "cleaning looks good, please continue". Then notify the user to close the Titleblock DWG to proceed if they selected an option to fix it themselves, otherwise save and close the DWG to continue.
5. the first CAD DWG should now open in AutoCAD and once it loads the command "CLEANCAD" is automatically run from the AutoCAD command line and we wait for the process to finish. Automatically save as the file with the name including the sheet layout names separated by spaces such as "E00.00 E00.01" if the sheet layout names are "Model" "E00.00" "E00.01" always skipping "Model" sheet, after complete, close the file.
6. Repeat the cleaning process for all CAD DWGS excluding the DWGs in the Xrefs folder that not the Title block DWG.
7. Once the title block DWG and all CAD DWGs have been processed, open the resulting folder with the processed CAD DWGs for the user to see and do as they please.

Currently the "Clean DWGs" tool is incomplete, because of the following:
- The tool moves too quickly when cleaning the CAD DWGs. It opens and closes some files without giving a chance for it to load and run "CLEANCAD". This results in some files not receiving "Save as" command, therefore it does not get cleaned. Please fix the timing of the saved CAD files.
- Please remove the notification that informs me that the title block file has been opened. I only care to be notified after it has been cleaned.